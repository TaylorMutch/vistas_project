var THREEx=THREEx||{};!function(){var t=function(t,e){return e=e||"image/png",console.log("Scene captured, opening new window..."),t.domElement.toDataURL(e)},e=function(t,e,n,i){var a=function(t,e,n,i){var a=i/n;return n>=t&&1>=a?(n=t,i=t*a):i>=e&&(i=e,n=e/a),{width:n,height:i}},h=function(){var t=document.createElement("canvas");t.width=e,t.height=n;var h=t.getContext("2d");h.fillStyle="black",h.fillRect(0,0,t.width,t.height);var d=a(t.width,t.height,o.width,o.height),r=(t.width-d.width)/2,c=(t.height-d.height)/2;h.drawImage(o,r,c,d.width,d.height);var g="image/png",u=t.toDataURL(g);i&&i(u)}.bind(this),o=new Image;o.onload=h,o.src=t},n=function(t,n){n=n||{};var i=n.charCode||"p".charCodeAt(0),a=n.width,h=n.height,o=n.callback||function(t){window.open(t,"name-"+Math.random())},d=function(n){if(n.which===i){var d=this.toDataURL(t);void 0===a&&void 0===h?o(d):e(d,a,h,o)}}.bind(this);return document.addEventListener("keypress",d,!1),{unbind:function(){document.removeEventListener("keypress",d,!1)}}};THREEx.Screenshot={toDataURL:t,bindKey:n}}();